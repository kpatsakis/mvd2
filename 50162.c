static CVE_2011_4101_PATCHED_dissect_infiniband_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, gboolean starts_with_grh) gint offset = 0 ; if ( ! src_addr )  src_addr = ep_alloc ( ADDR_MAX_LEN ); if ( tree && tree -> parent )  tree = tree -> parent; if ( 0 && ! tree )  if ( starts_with_grh )  lnh_val = IBA_GLOBAL; offset += 1; lnh_val = tvb_get_guint8 ( tvb , offset ); lnh_val = lnh_val & 0x03; offset += 1; offset += 2; offset += 2; * ( ( guint16 * ) src_addr ) = tvb_get_ntohs ( tvb , offset ); switch ( lnh_val )  memcpy ( src_addr , & SRCgid , GID_SIZE ); SET_ADDRESS ( & pinfo -> src , AT_IB , GID_SIZE , src_addr ); 