static void CVE_2014_6410_VULN___udf_read_inode(struct inode *inode) struct fileEntry * fe ; uint16_t ident ; struct udf_inode_info * iinfo = UDF_I ( inode ) ; bh = udf_read_ptagged ( inode -> i_sb , & iinfo -> i_location , 0 , & ident ); if ( ! bh )  if ( ident != TAG_IDENT_FE && ident != TAG_IDENT_EFE && ident != TAG_IDENT_USE )  fe = ( struct fileEntry * ) bh -> b_data; if ( fe -> icbTag . strategyType == cpu_to_le16 ( 4096 ) )  struct buffer_head * ibh ; ibh = udf_read_ptagged ( inode -> i_sb , & iinfo -> i_location , 1 , & ident ); if ( ident == TAG_IDENT_IE && ibh )  struct kernel_lb_addr loc ; struct indirectEntry * ie ; ie = ( struct indirectEntry * ) ibh -> b_data; loc = lelb_to_cpu ( ie -> indirectICB . extLocation ); if ( ie -> indirectICB . extLength && ( nbh = udf_read_ptagged ( inode -> i_sb , & loc , 0 , & ident ) ) )  if ( ident == TAG_IDENT_FE || ident == TAG_IDENT_EFE )  CVE_2014_6410_VULN___udf_read_inode ( inode ); static void CVE_2014_6410_VULN___udf_read_inode(struct inode *inode) struct fileEntry * fe ; uint16_t ident ; struct udf_inode_info * iinfo = UDF_I ( inode ) ; bh = udf_read_ptagged ( inode -> i_sb , & iinfo -> i_location , 0 , & ident ); if ( ! bh )  if ( ident != TAG_IDENT_FE && ident != TAG_IDENT_EFE && ident != TAG_IDENT_USE )  fe = ( struct fileEntry * ) bh -> b_data; if ( fe -> icbTag . strategyType == cpu_to_le16 ( 4096 ) )  struct buffer_head * ibh ; ibh = udf_read_ptagged ( inode -> i_sb , & iinfo -> i_location , 1 , & ident ); if ( ident == TAG_IDENT_IE && ibh )  struct kernel_lb_addr loc ; struct indirectEntry * ie ; ie = ( struct indirectEntry * ) ibh -> b_data; loc = lelb_to_cpu ( ie -> indirectICB . extLocation ); if ( ie -> indirectICB . extLength && ( nbh = udf_read_ptagged ( inode -> i_sb , & loc , 0 , & ident ) ) )  if ( ident == TAG_IDENT_FE || ident == TAG_IDENT_EFE )  CVE_2014_6410_VULN___udf_read_inode ( inode ); static void CVE_2014_6410_VULN___udf_read_inode(struct inode *inode) struct fileEntry * fe ; uint16_t ident ; struct udf_inode_info * iinfo = UDF_I ( inode ) ; bh = udf_read_ptagged ( inode -> i_sb , & iinfo -> i_location , 0 , & ident ); if ( ! bh )  if ( ident != TAG_IDENT_FE && ident != TAG_IDENT_EFE && ident != TAG_IDENT_USE )  fe = ( struct fileEntry * ) bh -> b_data; if ( fe -> icbTag . strategyType == cpu_to_le16 ( 4096 ) )  struct buffer_head * ibh ; ibh = udf_read_ptagged ( inode -> i_sb , & iinfo -> i_location , 1 , & ident ); if ( ident == TAG_IDENT_IE && ibh )  struct kernel_lb_addr loc ; struct indirectEntry * ie ; ie = ( struct indirectEntry * ) ibh -> b_data; loc = lelb_to_cpu ( ie -> indirectICB . extLocation ); if ( ie -> indirectICB . extLength && ( nbh = udf_read_ptagged ( inode -> i_sb , & loc , 0 , & ident ) ) )  if ( ident == TAG_IDENT_FE || ident == TAG_IDENT_EFE )  CVE_2014_6410_VULN___udf_read_inode ( inode ); static void CVE_2014_6410_VULN___udf_read_inode(struct inode *inode) struct fileEntry * fe ; uint16_t ident ; struct udf_inode_info * iinfo = UDF_I ( inode ) ; bh = udf_read_ptagged ( inode -> i_sb , & iinfo -> i_location , 0 , & ident ); if ( ! bh )  if ( ident != TAG_IDENT_FE && ident != TAG_IDENT_EFE && ident != TAG_IDENT_USE )  fe = ( struct fileEntry * ) bh -> b_data; if ( fe -> icbTag . strategyType == cpu_to_le16 ( 4096 ) )  struct buffer_head * ibh ; ibh = udf_read_ptagged ( inode -> i_sb , & iinfo -> i_location , 1 , & ident ); if ( ident == TAG_IDENT_IE && ibh )  struct kernel_lb_addr loc ; struct indirectEntry * ie ; ie = ( struct indirectEntry * ) ibh -> b_data; loc = lelb_to_cpu ( ie -> indirectICB . extLocation ); if ( ie -> indirectICB . extLength && ( nbh = udf_read_ptagged ( inode -> i_sb , & loc , 0 , & ident ) ) )  if ( ident == TAG_IDENT_FE || ident == TAG_IDENT_EFE )  memcpy ( & iinfo -> i_location , & loc , sizeof ( struct kernel_lb_addr ) ); 