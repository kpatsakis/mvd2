static unsigned int CVE_2014_1690_PATCHED_help(struct sk_buff enum ip_conntrack_info unsigned int unsigned int unsigned int struct nf_conntrack_expect *exp) char buffer [ sizeof ( "4294967296 65635" ) ] ; struct nf_conn * ct = exp -> master ; union nf_inet_addr newaddr ; u_int16_t port ; unsigned int ret ; newaddr = ct -> tuplehash [ IP_CT_DIR_REPLY ] . tuple . dst . u3; exp -> saved_proto . tcp . port = exp -> tuple . dst . u . tcp . port; exp -> dir = IP_CT_DIR_REPLY; exp -> expectfn = nf_nat_follow_master; for (port = ntohs(exp->saved_proto.tcp.port); port != 0; port++) int ret ; exp -> tuple . dst . u . tcp . port = htons ( port ); ret = nf_ct_expect_related ( exp ); if ( ret == 0 )  if ( ret != - EBUSY )  port = 0; if ( port == 0 )  snprintf ( buffer , sizeof ( buffer ) , "%u %u" , ntohl ( newaddr . ip ) , port ); pr_debug ( "nf_nat_irc: inserting '%s' == %pI4, port %u\n" , buffer , & newaddr . ip , port ); ret = nf_nat_mangle_tcp_packet ( skb , ct , ctinfo , protoff , matchoff , matchlen , buffer , strlen ( buffer ) ); if ( ret != NF_ACCEPT )  return ret ; 