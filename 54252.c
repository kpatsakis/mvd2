static nstrace_add_abstime(wtap_dumper *wdh, const struct wtap_pkthdr const guint8 *pd, int *err) guint64 nsg_creltime ; if ( wdh -> file_type_subtype == WTAP_FILE_TYPE_SUBTYPE_NETSCALER_1_0 )  guint16 val16 ; guint32 reltime ; guint64 abstime ; nspr_abstime_v10_t abs10 ; val16 = GUINT16_TO_LE ( NSPR_ABSTIME_V10 ); memcpy ( abs10 . phd . ph_RecordType , & val16 , sizeof abs10 . phd . ph_RecordType ); val16 = GUINT16_TO_LE ( nspr_abstime_v10_s ); memcpy ( abs10 . phd . ph_RecordSize , & val16 , sizeof abs10 . phd . ph_RecordSize ); memcpy ( & reltime , ( ( const nspr_pktracefull_v10_t * ) pd ) -> fp_RelTimeHr , sizeof reltime ); nsg_creltime = ns_hrtime2nsec ( reltime ); static guint64 ns_hrtime2nsec(guint32 tm) guint32 val = tm & NSPR_HRTIME_MASKTM ; switch ( tm & NSPR_HRTIME_MASKFMT )  return ( guint64 ) val * 1000000000 ; return ( guint64 ) val * 1000000 ; return ( guint64 ) val * 1000 ; return val ; return tm ; memset ( abs10 . abs_RelTime , 0 , sizeof abs10 . abs_RelTime ); abstime = GUINT32_TO_LE ( ( guint32 ) phdr -> ts . secs - ( guint32 ) ( nsg_creltime / 1000000000 ) ); memcpy ( abs10 . abs_Time , & abstime , sizeof abs10 . abs_Time ); if ( ! wtap_dump_file_write ( wdh , & abs10 , nspr_abstime_v10_s , err ) )  