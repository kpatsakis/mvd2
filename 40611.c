static gboolean nstrace_add_signature(wtap_dumper *wdh, int *err) if ( wdh -> file_type_subtype == WTAP_FILE_TYPE_SUBTYPE_NETSCALER_1_0 )  if ( wdh -> file_type_subtype == WTAP_FILE_TYPE_SUBTYPE_NETSCALER_2_0 )  if ( wdh -> file_type_subtype == WTAP_FILE_TYPE_SUBTYPE_NETSCALER_3_0 )  nspr_signature_v30_t sig30 ; sig30 . sig_RecordType = NSPR_SIGNATURE_V30; sig30 . sig_RecordSize = nspr_signature_v30_s; memcpy ( sig30 . sig_Signature , NSPR_SIGSTR_V30 , sizeof ( NSPR_SIGSTR_V30 ) ); if ( ! wtap_dump_file_write ( wdh , & sig30 , sig30 . sig_RecordSize , err ) )  nstrace -> page_offset += ( guint16 ) sig30 . sig_RecordSize; 