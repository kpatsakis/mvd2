static long CVE_2012_6547_PATCHED___tun_chr_ioctl(struct file *file, unsigned int unsigned long arg, int ifreq_len) struct ifreq ifr ; if ( cmd == TUNSETIFF || _IOC_TYPE ( cmd ) == 0x89 )  memset ( & ifr , 0 , sizeof ( ifr ) ); ifr . ifr_name [ IFNAMSIZ - 1 ] = '\0'; ret = tun_set_iff ( tfile -> net , file , & ifr ); if ( ret )  if ( copy_to_user ( argp , & ifr , ifreq_len ) )  return ret ; 