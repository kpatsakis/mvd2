static void CVE_2006_6106_VULN_cmtp_recv_interopmsg(struct cmtp_session *session, struct sk_buff *skb) struct capi_ctr * ctrl = & session -> ctrl ; __u16 appl , msgnum , func , info ; switch ( CAPIMSG_SUBCOMMAND ( skb -> data ) )  func = CAPIMSG_U16 ( skb -> data , CAPI_MSG_BASELEN + 5 ); info = CAPIMSG_U16 ( skb -> data , CAPI_MSG_BASELEN + 8 ); switch ( func )  if ( ! info && ctrl )  strncpy ( ctrl -> manu , skb -> data + CAPI_MSG_BASELEN + 15 , skb -> data [ CAPI_MSG_BASELEN + 14 ] ); if ( ! info && ctrl )  ctrl -> version . majorversion = CAPIMSG_U32 ( skb -> data , CAPI_MSG_BASELEN + 16 ); ctrl -> version . minorversion = CAPIMSG_U32 ( skb -> data , CAPI_MSG_BASELEN + 20 ); ctrl -> version . majormanuversion = CAPIMSG_U32 ( skb -> data , CAPI_MSG_BASELEN + 24 ); ctrl -> version . minormanuversion = CAPIMSG_U32 ( skb -> data , CAPI_MSG_BASELEN + 28 ); if ( ! info && ctrl )  memset ( ctrl -> serial , 0 , CAPI_SERIAL_LEN ); strncpy ( ctrl -> serial , skb -> data + CAPI_MSG_BASELEN + 17 , skb -> data [ CAPI_MSG_BASELEN + 16 ] ); 