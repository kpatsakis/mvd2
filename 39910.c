static brcmf_cfg80211_flush_pmksa(struct wiphy *wiphy, struct net_device *ndev) struct brcmf_cfg80211_info * cfg = wiphy_to_cfg ( wiphy ) ; struct brcmf_if * ifp = netdev_priv ( ndev ) ; if ( ! check_vif_up ( ifp -> vif ) )  static bool check_vif_up(struct brcmf_cfg80211_vif *vif) if ( ! test_bit ( BRCMF_VIF_STATUS_READY , & vif -> sme_state ) )  return false ; return true ; memset ( & cfg -> pmk_list , 0 , sizeof ( cfg -> pmk_list ) ); err = brcmf_update_pmklist ( cfg , ifp ); static __used brcmf_update_pmklist(struct brcmf_cfg80211_info *cfg, struct brcmf_if *ifp) pmk_list = & cfg -> pmk_list; npmk = le32_to_cpu ( pmk_list -> npmk ); brcmf_dbg ( CONN , "No of elements %d\n" , npmk ); for (i = 0; i < npmk; i++) brcmf_dbg ( CONN , "PMK[%d]: %pM\n" , i , & pmk_list -> pmk [ i ] . bssid ); err = brcmf_fil_iovar_data_set ( ifp , "pmkid_info" , pmk_list , sizeof ( * pmk_list ) ); return err ; return err ; 