static int CVE_2011_1147_VULN_udptl_rx_packet(struct ast_udptl *s, uint8_t *buf, int len) int stat ; int x ; int ptr ; int seq_no ; const uint8_t * ifp ; int ifp_len ; ptr = 0; if ( ptr + 2 > len )  seq_no = ( buf [ 0 ] << 8 ) | buf [ 1 ]; ptr += 2; if ( ( stat = decode_open_type ( buf , len , & ptr , & ifp , & ifp_len ) ) != 0 )  if ( ptr + 1 > len )  if ( ( buf [ ptr ++ ] & 0x80 ) == 0 )  if ( ifp_len > LOCAL_FAX_MAX_DATAGRAM )  for ( ; seq_no > s->rx_seq_no; s->rx_seq_no++) x = s -> rx_seq_no & UDPTL_BUF_MASK; s -> rx [ x ] . buf_len = - 1; s -> rx [ x ] . fec_len [ 0 ] = 0; s -> rx [ x ] . fec_span = 0; s -> rx [ x ] . fec_entries = 0; x = seq_no & UDPTL_BUF_MASK; memcpy ( s -> rx [ x ] . buf , ifp , ifp_len ); 