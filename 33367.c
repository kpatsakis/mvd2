int CVE_2012_2669_VULN_main(void) int fd , len , sock_opt ; fd = socket ( AF_NETLINK , SOCK_DGRAM , NETLINK_CONNECTOR ); if ( fd < 0 )  syslog ( LOG_ERR , "netlink socket creation failed; error:%d" , fd ); error = bind ( fd , ( struct sockaddr * ) & addr , sizeof ( addr ) ); if ( error < 0 )  syslog ( LOG_ERR , "bind failed; error:%d" , error ); close ( fd ); setsockopt ( fd , 270 , 1 , & sock_opt , sizeof ( sock_opt ) ); len = netlink_send ( fd , message ); if ( len < 0 )  syslog ( LOG_ERR , "netlink_send failed; error:%d" , len ); close ( fd ); pfd . fd = fd; pfd . events = POLLIN; pfd . revents = 0; poll ( & pfd , 1 , - 1 ); len = recv ( fd , kvp_recv_buffer , sizeof ( kvp_recv_buffer ) , 0 ); if ( len < 0 )  syslog ( LOG_ERR , "recv failed; error:%d" , len ); close ( fd ); len = netlink_send ( fd , incoming_cn_msg ); if ( len < 0 )  syslog ( LOG_ERR , "net_link send failed; error:%d" , len ); 