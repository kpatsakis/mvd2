static int CVE_2012_6617_PATCHED_prepare_sdp_description(FFStream *stream, uint8_t struct in_addr my_ip) AVFormatContext * avc ; AVStream * avs = NULL ; AVOutputFormat * rtp_format = av_guess_format ( "rtp" , NULL , NULL ) ; avc = avformat_alloc_context ( ); if ( avc == NULL || ! rtp_format )  avc -> oformat = rtp_format; avc -> nb_streams = stream -> nb_streams; if ( stream -> is_multicast )  snprintf ( avc -> filename , 1024 , "rtp://0.0.0.0" ); if ( avc -> nb_streams >= INT_MAX / sizeof ( * avc -> streams ) || ! ( avc -> streams = av_malloc ( avc -> nb_streams * sizeof ( * avc -> streams ) ) ) )  if ( avc -> nb_streams >= INT_MAX / sizeof ( * avs ) || ! ( avs = av_malloc ( avc -> nb_streams * sizeof ( * avs ) ) ) )  * pbuffer = av_mallocz ( 2048 ); return strlen ( * pbuffer ) ; 