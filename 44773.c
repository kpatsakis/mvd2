int CVE_2013_1707_PATCHED_NS_main(int argc, NS_tchar **argv) if ( argc < 3 )  __int64 pid = 0 ; if ( argc > 3 )  pid = _wtoi64 ( argv [ 3 ] ); if ( pid == - 1 )  if ( NS_tstrstr ( argv [ 3 ] , NS_T ( "/replace" ) ) )  sReplaceRequest = true; if ( sReplaceRequest )  NS_tchar installDir [ MAXPATHLEN ] ; if ( ! GetInstallationDir ( installDir ) )  if ( ! WriteStatusFile ( "applying" ) )  if ( pid > 0 )  HANDLE parent = OpenProcess ( SYNCHRONIZE , false , ( DWORD ) pid ) ; if ( parent )  DWORD result = WaitForSingleObject ( parent , 5000 ) ; if ( result != WAIT_OBJECT_0 )  sUsingService = getenv ( "MOZ_USING_SERVICE" ) != NULL; if ( ! sUsingService && ( argc > callbackIndex || sBackgroundUpdate || sReplaceRequest ) )  LaunchCallbackApp ( argv [ 4 ] , argc - callbackIndex , argv + callbackIndex , sUsingService ); LaunchCallbackApp ( argv [ 4 ] , argc - callbackIndex , argv + callbackIndex , sUsingService ); LaunchCallbackApp ( argv [ 4 ] , argc - callbackIndex , argv + callbackIndex , sUsingService ); LaunchCallbackApp ( argv [ 4 ] , argc - callbackIndex , argv + callbackIndex , sUsingService ); if ( ! sUsingService )  LaunchCallbackApp ( argv [ 4 ] , argc - callbackIndex , argv + callbackIndex , sUsingService ); 