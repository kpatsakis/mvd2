static long hiddev_compat_ioctl(struct file *file, unsigned int cmd, unsigned long arg) return hiddev_ioctl ( file , cmd , ( unsigned long ) compat_ptr ( arg ) ) ; static long hiddev_ioctl(struct file *file, unsigned int cmd, unsigned long arg) struct hiddev_list * list = file -> private_data ; struct hiddev * hiddev = list -> hiddev ; struct hid_device * hid ; if ( ! hiddev -> exist )  hid = hiddev -> hid; switch ( cmd )  if ( _IOC_TYPE ( cmd ) != 'H' || _IOC_DIR ( cmd ) != _IOC_READ )  if ( _IOC_NR ( cmd ) == _IOC_NR ( HIDIOCGNAME ( 0 ) ) )  if ( _IOC_NR ( cmd ) == _IOC_NR ( HIDIOCGPHYS ( 0 ) ) )  int len = strlen ( hid -> phys ) + 1 ; if ( len > _IOC_SIZE ( cmd ) )  r = copy_to_user ( user_arg , hid -> phys , len ) ? - EFAULT : len; return r ; 