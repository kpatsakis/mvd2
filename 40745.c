int main(int argc, char **argv) int shmsz ; int shmid ; key_t key ; char * str = NULL ; int c ; int errors = 0 ; while ( ( c = getopt ( argc , argv , "k:s:m:o:h" ) ) != - 1 )  switch ( c )  if ( ( key = strtol ( optarg , NULL , 10 ) ) < 1000 )  errors ++; if ( ( shmsz = atoi ( optarg ) ) <= 0 )  errors ++; str = optarg; errors ++; if ( ! str )  errors ++; if ( strlen ( str ) >= shmsz )  fprintf ( stderr , "Data too large for shared memory segment.\n" ); errors ++; if ( errors )  if ( ( shmid = shmget ( key , shmsz , IPC_CREAT | 0666 ) ) < 0 )  fprintf ( stderr , "shmget error\n" ); 